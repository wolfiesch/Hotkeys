<!-- Generated by SpecStory -->

# Create hotkey for paste formula (2025-08-13 22:22Z)

_**User**_

do we have a hotkey for paste formula and number formatting, with skip blanks enabled? if not, please map to caps-lock + F

---

_**Assistant**_

<think><details><summary>Thought Process</summary>**Understanding hotkey mapping**

I need to figure out the code in HOT.AHK because the user is asking about a hotkey for "paste formula and number formatting" while enabling skip blanks, which is an Excel paste special operation. They want to map this to CapsLock + F if it doesn't already exist. I’ll search the AHK script for any current hotkeys related to paste special, using the developer tool instructions and patterns like "CapsLock & f" to ensure it’s mapped correctly.
**Checking hotkey conflicts**

I need to make sure that any existing mappings don’t conflict with what the user wants. So, I'll search for "CapsLock &" combinations and see if there's already a hotkey for paste special with formulas and number formatting while skipping blanks. AHK can send keys to Excel using shortcuts like Alt+E S or Ctrl+Alt+V to open the Paste Special dialog, where the options, including formulas, locations are manageable. There's also a chance options for that may include shifts in key selections. I’ll need to confirm those details!
**Verifying Excel hotkeys and AHK version**

I need to check if in newer Excel, the hotkey for "Formulas & Number Formats" is actually 'O.' The accelerator letters can vary by version or locale, which complicates things. An alternative is using the Ribbon sequence Alt, H, V, S to open the dialog, then I might need to use 'R.' For older versions, once I open it, pressing 'R' could work too. I can't browse the web easily, but I can use COM automation to call Range.PasteSpecial. To determine the AHK version, I should read the entire HOT.AHK file for clarity.</details></think>

---

I'll scan the AHK script to see if a hotkey for "Paste formulas and number formats with skip blanks" already exists and whether CapsLock+F is free. If it's missing, I'll add a robust Excel-specific implementation.

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Evaluating hotkey mapping**

I need to address the user's question about a hotkey for pasting formulas and number formatting while skipping blanks. I've found a function, Excel_PasteFormulasAndNumberFormats_SkipBlanks(), defined in the code. However, it doesn’t seem to have a hotkey assigned yet. I noticed that CapsLock + F is currently set for AutoFit columns, which would conflict with what the user wants. I’ll have to consider changing that mapping or suggesting an alternative option.
**Implementing key mapping**

I need to map CapsLock+F to the new function, which allows pasting formulas and number formatting while skipping blanks. However, it conflicts with the existing AutoFit mapping. Although the user didn't specifically ask to preserve AutoFit, I might consider moving it to another combo like CapsLock+I, just to keep options open. I'll ensure this mapping only works in Excel. I may also think about adding a tooltip for clarity, but I'm not too sure if it's necessary. The earlier mapping using CapsLock+E will stay unaffected.
**Ensuring functionality with COM**

I need to make sure the function uses COM where it's available—check! For fallbacks, it sends Ctrl+Alt+V to open the Paste Special dialog, followed by "f," "b," and Enter. Now, I'm a bit confused about which letter corresponds to "Formulas and number formats"—is it 'T,' 'U,' or maybe 'O'? I believe it's meant to be accessible through the Paste list in the dialog. I’ll keep the fallback as is for reliability and remember to preserve the file's tab indentation style while implementing the new binding for CapsLock+F.
**Reviewing indentation and function mapping**

I noticed that the code uses a mix of tabs and spaces for indentation, especially around the 'CapsLock & c::' mapping. The system reminds me to preserve the exact characters and width. In the existing block, CapsLock+F is mapped to AutoFit Columns, but we need to change it to Paste Special: Formulas and Number Formats while skipping blanks. The user didn’t request a replacement for AutoFit, so I should be cautious about making additional changes without explicit instructions. I might suggest a new mapping for AutoFit, like CapsLock+I, later on.
**Preparing to apply changes**

The developer guidelines remind me to keep things minimal while repurposing the mapping. I should check if any other existing mappings for paste formulas and skip blanks exist. The Ctrl+CapsLock & e debug suggests a paste mode, but it's not fully implemented. The user specifically requested CapsLock+F for this functionality. I'll also make sure not to leave dead code, so I might connect that debug mapping as well, but I'll keep it minimal. 

I'll use the apply_patch tool after getting a status update. Once the edit is made, a brief summary will be shared. The patch will replace lines 493-496 with the necessary context and updated comments. Let's get started on applying the patch!</details></think>

---

I looked through `HOT.AHK`. There is a function `Excel_PasteFormulasAndNumberFormats_SkipBlanks()` implemented, but no hotkey currently triggers it. `CapsLock+F` is currently bound to auto-fit columns. I’m going to remap `CapsLock+F` in Excel to call the paste special with formulas + number formats and skip blanks, replacing the auto-fit binding.

---



---



---

- Replaced the Excel binding for CapsLock+F to perform Paste Special: formulas + number formats with Skip blanks, using COM when available and falling back to the Paste Special dialog.
- No other hotkeys were changed.

You can now press CapsLock+F in Excel to paste formulas and number formats with skip blanks.

---

_**User**_

horizontal scroll isn't working - pls fix

---

_**Assistant**_



---

I'll scan the script for any WheelLeft/WheelRight or horizontal scroll overrides and restore reliable horizontal scrolling. If needed, I'll add a small, scoped fix for Excel and global apps.

---



---

<think><details><summary>Thought Process</summary>**Analyzing horizontal scroll issues**

I need to address why the horizontal scroll isn't functioning properly. It seems that there was a previous comment removing certain mappings that might have interfered with the default behavior. The user mentions issues in Excel or overall. In Windows, horizontal scroll should register using specific events like WheelLeft and WheelRight, but the current script lacks handlers for these. I wonder if removing the handlers is causing the problem, especially with how horizontal scrolling works in Excel.
**Implementing horizontal scroll fallback**

I need to create a reliable horizontal scrolling fallback by mapping Shift+WheelUp and WheelDown to WheelLeft and WheelRight. In AHK v2, using SendEvent("{WheelLeft}") seems valid since it supports those events. I also wonder about mapping Alt+Shift+Wheel. The current script has no wheel handlers, only #HotIf IsExcel() for CapsLock combos, which might block the events.  My plan includes setting global mapping: Shift+WheelUp and Shift+WheelDown for scrolling left and right, which should work in Excel and browsers.
**Addressing horizontal scroll issues in apps**

Some applications, like Excel, already use Shift+Wheel for horizontal scrolling, but the user reports that it's not working—perhaps due to mouse limitations. Adding the right mapping might help. I also want to ensure that horizontal tilt (WheelLeft/WheelRight) is passed through rather than blocked since AHK doesn't do that unless hotkeys are present. 

For trackpads that send horizontal scroll as WM_MOUSEHWHEEL, I think we should implement mappings that can inject events when using Shift+Wheel. As for Excel, I wonder if adjusting the delta for smoother scrolling might be beneficial. Also, I need to keep an eye on the file's indentation style since it mixes tabs and spaces.
**Planning horizontal scroll mappings**

I’ve noticed that the code uses tabs for indentation within blocks, and function definitions begin with no indentation, so I’ll preserve that format. I see a comment stating "Removed horizontal wheel mappings to restore default behavior." It sounds like those mappings were removed because they conflicted with default behaviors, but now the user reports horizontal scroll not working. 

To fix this, I can reintroduce mappings for Excel, mapping Shift+WheelUp/Down to send {WheelLeft}/{WheelRight}. I’ll ensure this only happens if Excel's default isn't working, as it could be redundant but still safe. For global settings, I'll add mappings in other apps but keep in mind to check if they aren't from Excel first.
**Finalizing horizontal scroll mapping**

I see that global mapping is usually safe, but there might be OS-level scroll issues with the tilt wheel. If horizontal scrolling isn’t working, it could be because AHK intercepts the wheel for something else. Since there are no wheel handlers, I think adding a global mapping for Shift+Wheel to produce horizontal scroll events is the simplest fix.

I’ll place this under the Global hotkeys section while ensuring it doesn’t conflict with Excel mappings. We can also create a specific Excel mapping for sending multiple deltas for more significant scrolling. I plan to implement the code with proper indentation and comments to maintain clarity, particularly focusing on the Excel section where the user mentioned an issue. Let's get started!</details></think>

---

I'll add an Excel-specific mapping so Shift+MouseWheel triggers horizontal scroll reliably and remove the placeholder comment. Then I'll check for any linter issues.

---



---



---

<think><details><summary>Thought Process</summary>**Addressing horizontal scroll issue**

I'm checking the developer instructions for updates and tool calls. The user reported that the horizontal scroll isn't working, which suggests there might be an issue with the default behavior. It looks like horizontal wheel mappings were removed previously. To fix this, I'm considering mapping Shift+Wheel to horizontal scrolling in Excel, but I wonder if that's enough. The user probably expects horizontal scrolling to work across applications, not just in Excel, so I need to clarify that.
**Clarifying scroll mappings**

I see that the previous comment about removing horizontal wheel mappings was specific to Excel. That means the user might be experiencing issues with horizontal scrolling in Excel alone. Given that, I could implement a global Shift+Wheel mapping to allow horizontal scrolling across applications. However, I need to be careful because this might interfere with other apps where Shift+Wheel serves different functions. I should clarify that while fixing for Excel, I'll make it global if the user needs it.
**Investigating scroll conflicts**

I'm considering that in Windows, Shift+Vertical Wheel can perform horizontal scrolling in certain applications, including Excel, which uses Shift+MouseWheel for that purpose. However, if we add our own mapping for Shift+WheelUp, it could cause the scroll action to trigger twice, leading to complications. If Excel's default isn't working, something in the AutoHotkey script may be interfering. Another thought is whether the user's hardware, like a tilt wheel, isn’t functioning. I could also consider mapping WheelLeft/WheelRight events for horizontal scrolling in Excel.
**Considering scroll mapping alternatives**

I’m exploring options to map 'XButton1/XButton2' or 'MButton+Wheel' for horizontal scrolling. It seems remapping Shift+Wheel could help if the application doesn't already support it, but detecting that is tricky. I could add a condition for Excel, but since it already handles Shift+Wheel for horizontal scrolling, I'm worried about causing double scrolling. The user mentioned horizontal scrolling isn't working, likely in Excel. Perhaps my earlier changes to restore default behavior didn’t fully fix it. An alternative is to map 'WheelLeft/WheelRight' to simulate Shift+Vertical scrolling in apps that don’t support tilt.
**Refining scroll mapping logic**

The user reports that horizontal scrolling isn't working, so I'm considering mapping tilt scrolling to horizontal in Excel. I realize that WheelLeft/WheelRight events may not always be recognized. Windows typically sends these for horizontal scrolling, but if that fails, sending {Left 3} or {Right 3} could cause choppy scrolling. I also reflect on our mapping using '++', which likely indicates a Shift requirement but feels redundant. I should simplify this to '+WheelUp' and '+WheelDown'. I’ll correct my code and ensure the mappings properly support horizontal scrolling in Excel, minimizing any risks. Let's apply those changes!</details></think>

---

I'll correct the hotkey syntax to use '+WheelUp' and '+WheelDown' (Shift+Wheel) in the Excel scope to avoid potential ambiguity with '++WheelUp'. Then I'll recheck for linter issues.

---



---

<think><details><summary>Thought Process</summary>**Fixing hotkey conflicts**

I noticed that our previous patch included "++WheelUp," which seems incorrect. My attempts to fix it failed due to a mismatch, possibly because of changed quoting or positioning. I’ll need to read the file around the Excel section to see the current content. The plan is to change "++WheelUp" to "+WheelUp" and "++WheelDown" to "+WheelDown," making sure we’re applying this in an Excel context. The user mentioned horizontal scroll issues, so I’ll start with Excel.
**Updating hotkey mappings**

I noticed that our previous script commented that we "removed horizontal wheel mappings to restore default behavior." We added a mapping under IsExcel(), but I realized I used the wrong syntax with '++WheelUp.' AHK v2 requires modifiers, so the correct format for Shift+WheelUp should be "+WheelUp::." We need to update the code carefully while ensuring we maintain the indentation style since the file inconsistently uses tabs and spaces. I’ll read the content around the 460-470 lines to check the formatting.</details></think>

---

Read file: undefined

---

- I added Shift+WheelUp/Down to scroll horizontally in Excel and verified the syntax. Now I'll ensure there are no linter issues.

---



---

- Added Excel-scoped Shift+MouseWheel horizontal scrolling: `+WheelUp` → `WheelLeft`, `+WheelDown` → `WheelRight`.
- Verified no linter issues.

Try holding Shift while scrolling the mouse wheel in Excel. If you also want this behavior globally (not just in Excel), I can add it outside the Excel `#HotIf`.

---

_**User**_

Below is a ready-to-paste Cursor prompt that tells the agent exactly what to change in your AHK repo. It includes explicit patch instructions, exact code to insert, and acceptance criteria (so Cursor can make deterministic edits). Paste the whole thing into Cursor as a single prompt.

Goal
----
Modify the existing AutoHotkey v2 script in this repository to implement features 1, 2, 3 and 6 from Wolfgang's shortlist, and apply two global hygiene changes:
- Add and use a single tunable `KeyDelay := 40` at the top of the main script and replace existing literal `Sleep(60)` calls (and a small set of other obvious short sleeps used for UI timing) with `Sleep(KeyDelay)`.
- Add a `HOTKEYS.md` file documenting all new hotkeys (concise, copyable cheat sheet).

Target file(s)
--------------
- Find the primary AHK script in the repo (the file containing `#Requires AutoHotkey v2.0` and the CapsLock layer). Use that file as the edit target. If there are multiple `.ahk` files, prefer the one whose top lines include `#Requires AutoHotkey v2.0` and `#SingleInstance Force`.

High-level requirements
-----------------------
1) Implement a Hyper leader (Ctrl+Win+Alt) modal hotkey set:
   - `^!#t` -> open Windows Terminal (wt.exe)
   - `^!#c` -> open VS Code (`code`)
   - `^!#b` -> open Brave (example path: `C:\Program Files\BraveSoftware\Brave-Browser\Application\brave.exe`)
   - `^!#e` -> open Explorer (explorer.exe)
   - `^!#m` -> open Edge (msedge)
   Use `#HotIf` only where helpful; these are global.

2) Window snapping helpers (use built-in Win+Arrow synthetic presses):
   - `^!#Left`, `^!#Right`, `^!#Up`, `^!#Down` should send the OS Win+Arrow combos.
   Use safe, minimal `SendEvent` calls and `Sleep(KeyDelay)` where you already use sleeps to ensure timing stability.

3) Clipboard ring (small internal clipboard history):
   - Global ring array `ClipRing := []` and `ClipRingMax := 12`.
   - `^#c` copies selection and stores top-of-ring (copy-and-store).
   - `^!#v` pastes the top item from the ring (restoring user's clipboard after paste).
   - `^!#+v` rotates the ring forward (pop first -> push to end).
   Implement clipboard ops with `ClipboardAll()` backup and `try/finally` and conservative `ClipWait(0.25)`.

6) Send selection to Windows Terminal:
   - `^!#r` copies selection, opens wt in a new tab (`wt.exe -w 0 nt`), activates it, pastes the selection and presses Enter.
   - Use a best-effort fallback to paste into the currently active terminal if `wt.exe` fails.
   - Preserve original clipboard contents.

Global refactor
---------------
- Add `KeyDelay := 40` near the top (immediately below `#Requires` / global settings).
- Replace all occurrences of `Sleep(60)` with `Sleep(KeyDelay)`. Also replace obvious short sleeps that were used to time UI interactions with `Sleep(KeyDelay)` where semantics match: `Sleep(40)`, `Sleep(30)`, `Sleep(25)`, `Sleep(20)`, and `Sleep(120)` used in key timing should be replaced with `Sleep(KeyDelay)` for consistency unless a larger delay is obviously necessary (e.g., 500ms in cases that wait for an app to start) — preserve larger waits.

Style and safety
----------------
- Keep AHK v2 syntax and the existing style (functions, `try/catch`, `#HotIf`, `ClipboardAll()` backups).
- Use `SendEvent` (or `Send`) consistently with the rest of the file.
- Avoid introducing hotkey collisions with existing Caps layer. If a conflict exists, prefer the new Hyper combos (but do not remove existing Caps combos).
- Add short inline comments for each new function/hotkey block.

Files to add
------------
- `HOTKEYS.md` at repo root with a concise table/list of the new hotkeys and a one-line description for each. Include the Caps-layer top-level reminder and the new Hyper combos.

Exact code to insert
--------------------
Insert (or merge) the following code snippets into the main script. Keep them near other global hotkeys and utility functions. Use existing helper naming conventions.

1) Add KeyDelay near top (immediately after global settings):
```ahk
; tuning
KeyDelay := 40   ; global key/macro delay (ms) - tune this once


Hyper leader and snap helpers (paste into global hotkey section):

; --------------- Hyper leader (Ctrl+Win+Alt) and window snap ---------------
; hyper = Ctrl+Win+Alt
; quick app launchers
^!#t:: { Try Run("wt.exe -w 0 nt") }
^!#c:: { Try Run("code") }
^!#b:: { Try Run("C:\Program Files\BraveSoftware\Brave-Browser\Application\brave.exe") }
^!#e:: { Try Run("explorer.exe") }
^!#m:: { Try Run("msedge") }

; use Windows built-in snap (Win+Arrows) via synthetic send
^!#Left:: { SendEvent("{LWin down}{Left}{LWin up}") ;Small delay to stabilize if needed
            Sleep(KeyDelay) }
^!#Right:: { SendEvent("{LWin down}{Right}{LWin up}") ;Small delay to stabilize if needed
             Sleep(KeyDelay) }
^!#Up:: { SendEvent("{LWin down}{Up}{LWin up}") ; maximize/restore
         Sleep(KeyDelay) }
^!#Down:: { SendEvent("{LWin down}{Down}{LWin up}") ; restore/minimize
           Sleep(KeyDelay) }


Clipboard ring (paste near other clipboard utilities):

; --------------- Simple clipboard ring ---------------
global ClipRing := []        ; newest at index 1
global ClipRingMax := 12

; copy-and-store: Ctrl+Win+C
^#c:: {
    global ClipRing, ClipRingMax
    backup := ClipboardAll()
    try {
        A_Clipboard := ""
        Send("^c")
        if !ClipWait(0.25) {
            return
        }
        ClipText := A_Clipboard
        if (ClipText != "") {
            ClipRing.InsertAt(1, ClipText)
            while (ClipRing.Length() > ClipRingMax)
                ClipRing.Pop()
        }
    } finally {
        A_Clipboard := backup
    }
}

; Hyper+V -> paste top item from ring without destroying user's clipboard
^!#v:: {
    global ClipRing
    if (ClipRing.Length() = 0)
        return
    backup := ClipboardAll()
    try {
        A_Clipboard := ClipRing[1]
        Send("^v")
        Sleep(KeyDelay)
    } finally {
        A_Clipboard := backup
    }
}

; Hyper+Shift+V -> rotate ring (move first to last)
^!#+v:: {
    global ClipRing
    if (ClipRing.Length() > 1) {
        ClipRing.Push(ClipRing.RemoveAt(1))
    }
}


Send selection to Windows Terminal ^!#r (place with other quick app actions)

; --------------- Send selection to Windows Terminal (Hyper+R) ---------------
^!#r:: {
    backup := ClipboardAll()
    try {
        A_Clipboard := ""
        Send("^c")
        if !ClipWait(0.25) {
            A_Clipboard := backup
            return
        }
        clip := A_Clipboard
        A_Clipboard := backup

        Try {
            Run("wt.exe -w 0 nt")
            ; wait for wt to appear. give a small timeout
            WinWait("ahk_exe WindowsTerminal.exe", "", 2)
            Sleep(500) ; allow terminal to be ready
            WinActivate("ahk_exe WindowsTerminal.exe")
            Sleep(KeyDelay)
            ; paste and run
            Send("^v")
            Sleep(KeyDelay)
            Send("{Enter}")
        } Catch {
            ; fallback to active window paste + Enter
            A_Clipboard := clip
            Send("^v")
            Sleep(KeyDelay)
            Send("{Enter}")
            A_Clipboard := backup
        }
    } finally {
        ; restore original clipboard (if not overwritten by fallback above)
        A_Clipboard := backup
    }
}

HOTKEYS.md template

Create HOTKEYS.md at repo root with this content (cursor should create and populate file):

# Hotkeys cheat sheet

Global
- Ctrl+Win+Alt + t - Open Windows Terminal (`wt.exe -w 0 nt`)
- Ctrl+Win+Alt + c - Open VS Code (`code`)
- Ctrl+Win+Alt + b - Open Brave browser
- Ctrl+Win+Alt + e - Open Explorer
- Ctrl+Win+Alt + m - Open Edge
- Ctrl+Win+Left/Right/Up/Down - Windows snap (tile left/right/maximize/minimize)

Clipboard ring
- Ctrl+Win+C - Copy selection and push to the internal clipboard ring
- Ctrl+Win+Alt+V - Paste top item from clipboard ring (preserves your clipboard)
- Ctrl+Win+Alt+Shift+V - Rotate clipboard ring (move top to bottom)

Terminal send
- Ctrl+Win+Alt+R - Copy selection, open new Windows Terminal tab, paste and run (fallback to active terminal if wt not present)

Tuning
- `KeyDelay` is defined in the script (default 40ms). Tune to adjust interactions with UI.

Caps-layer
- Your existing CapsLock-layer combos remain; this file adds a separate Hyper leader and helpers.

Acceptance criteria

The main AHK script contains KeyDelay := 40 near the top.

All literal Sleep(60) occurrences are replaced with Sleep(KeyDelay). Short UI timing sleeps listed earlier (40/30/25/20/120) should be replaced too where appropriate; large waits (>= 400ms) remain unchanged unless obviously redundant.

The new Hyper hotkeys (^!#t, ^!#c, ^!#b, ^!#e, ^!#m) are present and runnable.

The new snap hotkeys (^!#Left/Right/Up/Down) are present and call Win+Arrow via SendEvent.

Clipboard ring implemented with ClipRing and hotkeys ^#c, ^!#v, ^!#+v are present and preserve the user's clipboard.

^!#r (send to Windows Terminal) implemented and uses wt.exe -w 0 nt with fallback.

HOTKEYS.md exists and includes the content above.

No syntax errors (AHK v2 style). Keep try/finally where clipboard is used.

Testing steps (manual)

Run the modified script.

Press Ctrl+Win+Alt+t — Windows Terminal should open.

Focus a browser page and press ^#c to copy some text, then ^!#v to paste it into a text field — clipboard should be preserved afterwards.

Select code in an editor, press ^!#r — a wt tab should open and paste+run the selection.

Test the snap keys with ^!#Left etc.

Verify no Caps layer collisions and that other existing hotkeys still function.

If anything conflicts with the existing CapsLock layer or other hotkeys, prefer to:

keep both bindings and add a comment in HOTKEYS.md explaining the overlap,

or add a short guard in the new hotkeys to check GetKeyState("CapsLock","P") and skip if Caps is being used as a layer.

Deliverable

A patch that updates the main AHK script as described.

A new HOTKEYS.md file created at repo root.

A short commit message: "add hyper leader, snap helpers, clipboard ring, send-to-terminal; add KeyDelay; add HOTKEYS.md"

You can apply the patch directly and run a syntax check. Keep changes minimal and local to the main AHK file and HOTKEYS.md. Thank you.

---

_**Assistant**_

<think><details><summary>Thought Process</summary>**Implementing configuration settings**

I need to add the `KeyDelay` setting near the top of the file, right below the global settings. This includes adding `KeyDelay := 40` in that section. I also want to define hotkeys for launching applications like Windows Terminal and various browsers. I'll establish clipboard functionality, allowing for copying selections and managing a clipboard ring. It’s important to ensure we restore the clipboard after using it. Lastly, I'll implement a method to send selections to Windows Terminal with the appropriate key bindings and fallback options.
**Adjusting sleep settings**

I need to carefully incorporate the backup and override interplay while adding the specified content for `HOTKEYS.md`. I should also review and adjust Sleep numbers throughout the existing code. I’ll scan for instances of Sleep to ensure nothing is overlooked—some replacements were made for new code, but not for existing calls. I’ll follow the developer instructions for tool usage, including brief status updates, parallelizing processes, and finding specific Sleep instances, especially looking for the less common values like 70. I aim to replace those short sleeps used for UI timing too.
**Finalizing delay and hotkey settings**

I want to ensure that I’m only replacing the specified short UI timing sleeps, so I’ll stick to the acceptance criteria, which mentions replacing values like 60, 40, 30, 25, 20, and 120, but not 70. Even though 70 feels somewhat short, it’s not on the list, so I’ll leave it as is. Next, I’ll confirm that the new hotkeys don’t conflict with existing ones. It seems the `^#c` hotkey may have potential conflicts, so I’ll double-check the script for existing combinations. Overall, I’ll keep the hotkeys global without using `#HotIf`.
**Ensuring correct syntax in AHK v2**

I need to revisit the "Try Run()" style because in AHK v2, it uses `try` in lowercase instead of uppercase `Try`. The snippet incorrectly uses 'Try Run("...")', which is invalid. To maintain consistency, I should use `try { Run("...") } catch {}` or just `Run("...")` without the `try`. I’m considering implementing it as `try Run(...)`, since AHK v2 does support the `try` statement, which properly leads into a function call. Also, braces are used for hotkey definitions in v2, like `^!#t:: { ... }`.</details></think>

---

